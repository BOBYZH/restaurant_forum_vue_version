(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-524de69e"],{5652:function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("7a23"),a=function(e){return Object(r["v"])("data-v-6ddf730a"),e=e(),Object(r["t"])(),e},c={class:"container py-5"},i={class:"my-4"},o={class:"form-row"},s={class:"col-auto"},u={class:"col-auto"},d=["disabled"],g={key:1,class:"table"},b=a((function(){return Object(r["g"])("thead",{class:"thead-dark"},[Object(r["g"])("tr",null,[Object(r["g"])("th",{scope:"col",width:"60"}," # "),Object(r["g"])("th",{scope:"col"}," Category Name "),Object(r["g"])("th",{scope:"col",width:"210"}," Action ")])],-1)})),l={scope:"row"},f={class:"position-relative"},m=["onUpdate:modelValue"],p=["onClick"],j={class:"d-flex justify-content-between"},O=["onClick"],h=["onClick"],v=["onClick"];function y(e,t,n,a,y,w){var k=Object(r["z"])("AdminNav"),C=Object(r["z"])("Spinner");return Object(r["s"])(),Object(r["f"])("div",c,[Object(r["i"])(k),Object(r["g"])("form",i,[Object(r["g"])("div",o,[Object(r["g"])("div",s,[Object(r["I"])(Object(r["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return y.newCategoryName=e}),type:"text",class:"form-control",placeholder:"新增餐廳類別..."},null,512),[[r["E"],y.newCategoryName]])]),Object(r["g"])("div",u,[Object(r["g"])("button",{type:"button",class:"btn btn-primary",disabled:y.isProcessing,onClick:t[1]||(t[1]=Object(r["J"])((function(){return w.createCategory&&w.createCategory.apply(w,arguments)}),["stop","prevent"]))}," 新增 ",8,d)])])]),y.isLoading?(Object(r["s"])(),Object(r["d"])(C,{key:0})):(Object(r["s"])(),Object(r["f"])("table",g,[b,Object(r["g"])("tbody",null,[(Object(r["s"])(!0),Object(r["f"])(r["a"],null,Object(r["y"])(y.categories,(function(e){return Object(r["s"])(),Object(r["f"])("tr",{key:e.id},[Object(r["g"])("th",l,Object(r["B"])(e.id),1),Object(r["g"])("td",f,[Object(r["I"])(Object(r["g"])("div",{class:"category-name"},Object(r["B"])(e.name),513),[[r["F"],!e.isEditing]]),Object(r["I"])(Object(r["g"])("input",{"onUpdate:modelValue":function(t){return e.name=t},type:"text",class:"form-control"},null,8,m),[[r["F"],e.isEditing],[r["E"],e.name]]),Object(r["I"])(Object(r["g"])("span",{class:"cancel",onClick:function(t){return w.handleCancel(e.id)}}," ✕ ",8,p),[[r["F"],e.isEditing]])]),Object(r["g"])("td",j,[Object(r["I"])(Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["J"])((function(t){return w.toggleIsEditing(e.id)}),["stop","prevent"])}," Edit ",8,O),[[r["F"],!e.isEditing]]),Object(r["I"])(Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["J"])((function(t){return w.updateCategory({categoryId:e.id,name:e.name})}),["stop","prevent"])}," Save ",8,h),[[r["F"],e.isEditing]]),Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["J"])((function(t){return w.deleteCategory(e.id)}),["stop","prevent"])}," Delete ",8,v)])])})),128))])]))])}n("4de4"),n("d81d"),n("96cf");var w=n("1da1"),k=n("5530"),C=n("e04c"),I=n("be6c"),E=n("2fa3"),x=n("2375"),N={components:{AdminNav:C["a"],Spinner:x["a"]},data:function(){return{newCategoryName:"",categories:[],isProcessing:!1,isLoading:!0}},created:function(){this.fetchCategories()},methods:{toggleIsEditing:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(k["a"])(Object(k["a"])({},t),{},{isEditing:!t.isEditing,nameCached:t.name}):t}))},handleCancel:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(k["a"])(Object(k["a"])({},t),{},{name:t.nameCached}):t})),this.toggleIsEditing(e)},updateCategory:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function n(){var r,a,c,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.categoryId,a=e.name,n.prev=1,n.next=4,I["a"].categories.update({categoryId:r,name:a});case 4:if(c=n.sent,i=c.data,"error"!==i.status){n.next=8;break}throw new Error(i.message);case 8:t.toggleIsEditing(r),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](1),console.error(n.t0.message),E["a"].fire({icon:"error",title:"無法更新餐廳類別，請稍後再試"});case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))()},fetchCategories:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,I["a"].categories.get();case 4:if(n=t.sent,r=n.data,"error"!==r.status){t.next=8;break}throw new Error(r.message);case 8:e.categories=r.categories.map((function(e){return Object(k["a"])(Object(k["a"])({},e),{},{isEditing:!1,nameCached:""})})),e.isLoading=!1,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),e.isLoading=!1,console.error(t.t0.message),E["a"].fire({icon:"error",title:"無法取得餐廳類別，請稍後再試"});case 17:case"end":return t.stop()}}),t,null,[[0,12]])})))()},createCategory:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,I["a"].categories.create({name:e.newCategoryName});case 4:if(n=t.sent,r=n.data,"error"!==r.status){t.next=8;break}throw new Error(r.message);case 8:e.categories.push({id:r.categoryId,name:e.newCategoryName,isEditing:!1}),e.isProcessing=!1,e.newCategoryName="",t.next=18;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error(t.t0.message),e.isProcessing=!1,E["a"].fire({icon:"error",title:"無法新增餐廳類別，請稍後再試"});case 18:case"end":return t.stop()}}),t,null,[[0,13]])})))()},deleteCategory:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I["a"].categories.delete({categoryId:e});case 3:if(r=n.sent,a=r.data,"error"!==a.status){n.next=7;break}throw new Error(a.message);case 7:t.categories=t.categories.filter((function(t){return t.id!==e})),E["a"].fire({icon:"success",title:"成功刪除該餐廳類別"}),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](0),console.error(n.t0.message),E["a"].fire({icon:"error",title:"無法刪除該餐廳類別，請稍後再試"});case 15:case"end":return n.stop()}}),n,null,[[0,11]])})))()}}};n("cbff");N.render=y,N.__scopeId="data-v-6ddf730a";t["default"]=N},"681f":function(e,t,n){},be6c:function(e,t,n){"use strict";n("b0c0");var r=n("2fa3");t["a"]={categories:{getDetail:function(e){var t=e.categoryId;return r["b"].get("/admin/categories/".concat(t))},get:function(){return r["b"].get("/admin/categories")},create:function(e){var t=e.name;return r["b"].post("/admin/categories",{name:t})},update:function(e){var t=e.categoryId,n=e.name;return r["b"].put("/admin/categories/".concat(t),{name:n})},delete:function(e){var t=e.categoryId;return r["b"].delete("/admin/categories/".concat(t))}},restaurants:{getDetail:function(e){var t=e.restaurantId;return r["b"].get("/admin/restaurants/".concat(t))},get:function(){return r["b"].get("/admin/restaurants")},create:function(e){var t=e.formData;return r["b"].post("/admin/restaurants",t)},update:function(e){var t=e.restaurantId,n=e.formData;return r["b"].put("/admin/restaurants/".concat(t),n)},delete:function(e){var t=e.restaurantId;return r["b"].delete("/admin/restaurants/".concat(t))}},users:{get:function(){return r["b"].get("/admin/users")},update:function(e){var t=e.userId,n=e.isAdmin;return r["b"].put("/admin/users/".concat(t),{isAdmin:n})}}}},cbff:function(e,t,n){"use strict";n("681f")},d81d:function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").map,c=n("1dde"),i=n("ae40"),o=c("map"),s=i("map");r({target:"Array",proto:!0,forced:!o||!s},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},e04c:function(e,t,n){"use strict";var r=n("7a23"),a={class:"mb-3"},c=Object(r["g"])("h1",null,"餐廳後台",-1),i=Object(r["h"])(" Restaurants "),o=Object(r["h"])(" | "),s=Object(r["h"])(" Categories "),u=Object(r["h"])(" | "),d=Object(r["h"])(" Users ");function g(e,t){var n=Object(r["z"])("router-link");return Object(r["s"])(),Object(r["f"])("div",a,[c,Object(r["i"])(n,{to:"/admin/restaurants"},{default:Object(r["H"])((function(){return[i]})),_:1}),o,Object(r["i"])(n,{to:"/admin/categories"},{default:Object(r["H"])((function(){return[s]})),_:1}),u,Object(r["i"])(n,{to:"/admin/users"},{default:Object(r["H"])((function(){return[d]})),_:1})])}const b={};b.render=g;t["a"]=b}}]);
//# sourceMappingURL=chunk-524de69e.dcf78317.js.map