(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ca49a1e"],{"571a":function(t,e,r){"use strict";r.r(e);r("a4d3"),r("e01a"),r("b0c0");var a=r("7a23"),n={class:"container py-5"},c=Object(a["g"])("h1",{class:"mt-5"}," 人氣餐廳 ",-1),s=Object(a["g"])("hr",null,null,-1),i={class:"row no-gutters"},o={class:"col-md-4"},u=["src"],b={class:"col-md-8"},d={class:"card-body"},l={class:"card-title"},p={class:"badge badge-secondary"},v={class:"card-text"},j=Object(a["h"])(" Show "),O=["onClick"],f=["onClick"];function m(t,e,r,m,g,h){var w=Object(a["z"])("NavTabs"),k=Object(a["z"])("Spinner"),F=Object(a["z"])("router-link");return Object(a["s"])(),Object(a["f"])("div",n,[Object(a["i"])(w),g.isLoading?(Object(a["s"])(),Object(a["d"])(k,{key:0})):(Object(a["s"])(),Object(a["f"])(a["a"],{key:1},[c,s,(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(g.restaurants,(function(t){return Object(a["s"])(),Object(a["f"])("div",{key:t.id,class:"card mb-3",style:{"max-width":"540px",margin:"auto"}},[Object(a["g"])("div",i,[Object(a["g"])("div",o,[Object(a["i"])(F,{to:{name:"restaurant",params:{id:t.id}}},{default:Object(a["H"])((function(){return[Object(a["g"])("img",{class:"card-img",src:t.image},null,8,u)]})),_:2},1032,["to"])]),Object(a["g"])("div",b,[Object(a["g"])("div",d,[Object(a["g"])("h5",l,Object(a["B"])(t.name),1),Object(a["g"])("span",p,"收藏數："+Object(a["B"])(t.FavoriteCount),1),Object(a["g"])("p",v,Object(a["B"])(t.description),1),Object(a["i"])(F,{class:"btn btn-primary mr-2",to:{name:"restaurant",params:{id:t.id}}},{default:Object(a["H"])((function(){return[j]})),_:2},1032,["to"]),t.isFavorited?(Object(a["s"])(),Object(a["f"])("button",{key:0,type:"button",class:"btn btn-danger mr-2",onClick:Object(a["J"])((function(e){return h.deleteFavorite(t.id)}),["stop","prevent"])}," 移除最愛 ",8,O)):(Object(a["s"])(),Object(a["f"])("button",{key:1,type:"button",class:"btn btn-primary",onClick:Object(a["J"])((function(e){return h.addFavorite(t.id)}),["stop","prevent"])}," 加到最愛 ",8,f))])])])])})),128))],64))])}r("d81d");var g=r("5530"),h=(r("96cf"),r("1da1")),w=r("2708"),k=r("8bb1"),F=r("c4c3"),x=r("4cce"),y=r("2fa3"),C=r("2375"),R={name:"RestaurantsTop",components:{NavTabs:k["a"],Spinner:C["a"]},mixins:[w["a"]],data:function(){return{restaurants:[],isLoading:!0}},created:function(){this.fetchTopRestaurants()},methods:{fetchTopRestaurants:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoading=!0,e.next=4,F["a"].getTopRestaurants();case 4:if(r=e.sent,a=r.data,"error"!==a.status){e.next=8;break}throw new Error(a.message);case 8:t.restaurants=a.restaurants,t.isLoading=!1,e.next=17;break;case 12:e.prev=12,e.t0=e["catch"](0),console.error(e.t0.message),t.isLoading=!1,y["a"].fire({icon:"error",title:"無法取得人氣餐廳，請稍後再試"});case 17:case"end":return e.stop()}}),e,null,[[0,12]])})))()},addFavorite:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].addFavorite({restaurantId:t});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:e.restaurants=e.restaurants.map((function(e){return e.id!==t?e:Object(g["a"])(Object(g["a"])({},e),{},{FavoriteCount:e.FavoriteCount+1,isFavorited:!0})})).sort((function(t,e){return e.FavoriteCount-t.FavoriteCount})),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),y["a"].fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},deleteFavorite:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x["a"].deleteFavorite({restaurantId:t});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:e.restaurants=e.restaurants.map((function(e){return e.id!==t?e:Object(g["a"])(Object(g["a"])({},e),{},{FavoriteCount:e.FavoriteCount-1,isFavorited:!1})})).sort((function(t,e){return e.FavoriteCount-t.FavoriteCount})),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),y["a"].fire({icon:"error",title:"無法將餐廳移除最愛，請稍後再試"});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()}}};R.render=m;e["default"]=R},d81d:function(t,e,r){"use strict";var a=r("23e7"),n=r("b727").map,c=r("1dde"),s=r("ae40"),i=c("map"),o=s("map");a({target:"Array",proto:!0,forced:!i||!o},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-6ca49a1e.885bfe38.js.map