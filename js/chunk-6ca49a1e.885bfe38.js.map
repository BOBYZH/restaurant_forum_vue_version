{"version":3,"sources":["webpack:///./src/views/RestaurantsTop.vue","webpack:///./src/views/RestaurantsTop.vue?4a7a","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["class","_createElementVNode","_createElementBlock","_createVNode","_component_NavTabs","$data","_createBlock","_component_Spinner","key","_Fragment","_hoisted_2","_hoisted_3","_renderList","restaurant","id","style","_component_router_link","to","name","params","src","image","_toDisplayString","FavoriteCount","description","isFavorited","type","onClick","$options","_hoisted_13","_hoisted_14","components","NavTabs","Spinner","mixins","emptyImageMethod","data","restaurants","isLoading","created","this","fetchTopRestaurants","methods","restaurantsAPI","getTopRestaurants","status","Error","message","console","error","Toast","fire","icon","title","addFavorite","restaurantId","usersAPI","map","sort","a","b","deleteFavorite","render","$","$map","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","target","proto","forced","callbackfn","arguments","length","undefined"],"mappings":"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","file":"js/chunk-6ca49a1e.885bfe38.js","sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <NavTabs />\r\n    <Spinner v-if=\"isLoading\" />\r\n    <template v-else>\r\n      <h1 class=\"mt-5\">\r\n        人氣餐廳\r\n      </h1>\r\n\r\n      <hr>\r\n      <div\r\n        v-for=\"restaurant in restaurants\"\r\n        :key=\"restaurant.id\"\r\n        class=\"card mb-3\"\r\n        style=\"max-width: 540px;margin: auto;\"\r\n      >\r\n        <div class=\"row no-gutters\">\r\n          <div class=\"col-md-4\">\r\n            <router-link\r\n              :to=\"{ name: 'restaurant', params: { id: restaurant.id } }\"\r\n            >\r\n              <img\r\n                class=\"card-img\"\r\n                :src=\"restaurant.image\"\r\n              >\r\n            </router-link>\r\n          </div>\r\n          <div class=\"col-md-8\">\r\n            <div class=\"card-body\">\r\n              <h5 class=\"card-title\">\r\n                {{ restaurant.name }}\r\n              </h5>\r\n              <span\r\n                class=\"badge badge-secondary\"\r\n              >收藏數：{{ restaurant.FavoriteCount }}</span>\r\n              <p class=\"card-text\">\r\n                {{ restaurant.description }}\r\n              </p>\r\n              <router-link\r\n                class=\"btn btn-primary mr-2\"\r\n                :to=\"{ name: 'restaurant', params: { id: restaurant.id } }\"\r\n              >\r\n                Show\r\n              </router-link>\r\n\r\n              <button\r\n                v-if=\"restaurant.isFavorited\"\r\n                type=\"button\"\r\n                class=\"btn btn-danger mr-2\"\r\n                @click.stop.prevent=\"deleteFavorite(restaurant.id)\"\r\n              >\r\n                移除最愛\r\n              </button>\r\n              <button\r\n                v-else\r\n                type=\"button\"\r\n                class=\"btn btn-primary\"\r\n                @click.stop.prevent=\"addFavorite(restaurant.id)\"\r\n              >\r\n                加到最愛\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { emptyImageMethod } from './../utils/mixins'\r\nimport NavTabs from './../components/NavTabs'\r\nimport restaurantsAPI from './../apis/restaurants'\r\nimport usersAPI from './../apis/users'\r\nimport { Toast } from '@/utils/helpers'\r\nimport Spinner from './../components/Spinner'\r\n\r\nexport default {\r\n  name: 'RestaurantsTop',\r\n  components: {\r\n    NavTabs,\r\n    Spinner\r\n  },\r\n  mixins: [emptyImageMethod],\r\n  data () {\r\n    return {\r\n      restaurants: [],\r\n      isLoading: true\r\n    }\r\n  },\r\n  created () {\r\n    this.fetchTopRestaurants()\r\n  },\r\n  methods: {\r\n    async fetchTopRestaurants () {\r\n      try {\r\n        this.isLoading = true\r\n        const { data } = await restaurantsAPI.getTopRestaurants()\r\n\r\n        if (data.status === 'error') {\r\n          throw new Error(data.message)\r\n        }\r\n\r\n        this.restaurants = data.restaurants\r\n        this.isLoading = false\r\n      } catch (error) {\r\n        console.error(error.message)\r\n        this.isLoading = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得人氣餐廳，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async addFavorite (restaurantId) {\r\n      try {\r\n        const { data } = await usersAPI.addFavorite({ restaurantId })\r\n        if (data.status !== 'success') {\r\n          throw new Error(data.message)\r\n        }\r\n        this.restaurants = this.restaurants\r\n          .map(restaurant => {\r\n            if (restaurant.id !== restaurantId) {\r\n              return restaurant\r\n            }\r\n            return {\r\n              ...restaurant,\r\n              FavoriteCount: restaurant.FavoriteCount + 1,\r\n              isFavorited: true\r\n            }\r\n          })\r\n          .sort((a, b) => b.FavoriteCount - a.FavoriteCount)\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法將餐廳加入最愛，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async deleteFavorite (restaurantId) {\r\n      try {\r\n        const { data } = await usersAPI.deleteFavorite({ restaurantId })\r\n        if (data.status !== 'success') {\r\n          throw new Error(data.message)\r\n        }\r\n        this.restaurants = this.restaurants\r\n          .map(restaurant => {\r\n            if (restaurant.id !== restaurantId) {\r\n              return restaurant\r\n            }\r\n            return {\r\n              ...restaurant,\r\n              FavoriteCount: restaurant.FavoriteCount - 1,\r\n              isFavorited: false\r\n            }\r\n          })\r\n          .sort((a, b) => b.FavoriteCount - a.FavoriteCount)\r\n      } catch (error) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法將餐廳移除最愛，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./RestaurantsTop.vue?vue&type=template&id=1f284b2a\"\nimport script from \"./RestaurantsTop.vue?vue&type=script&lang=js\"\nexport * from \"./RestaurantsTop.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n// FF49- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}