{"version":3,"sources":["webpack:///./src/views/AdminUsers.vue","webpack:///./src/views/AdminUsers.vue?8495","webpack:///./src/apis/admin.js","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/components/AdminNav.vue","webpack:///./src/components/AdminNav.vue?343e"],"names":["class","_createElementVNode","scope","width","_createElementBlock","_createVNode","_component_AdminNav","$data","_createBlock","_component_Spinner","key","_hoisted_3","_Fragment","_renderList","user","id","_toDisplayString","email","isAdmin","_ctx","type","onClick","$options","userId","_hoisted_5","components","AdminNav","Spinner","data","users","isLoading","computed","mapState","created","this","fetchUsers","methods","adminAPI","get","status","Error","message","console","error","Toast","fire","icon","title","toggleUserRole","update","toString","map","render","categories","getDetail","categoryId","apiHelper","create","name","post","put","delete","restaurants","restaurantId","formData","$","$map","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","target","proto","forced","callbackfn","arguments","length","undefined","_hoisted_2","_component_router_link","to","script"],"mappings":"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","file":"js/chunk-958bdcfa.bd95f78d.js","sourcesContent":["<template>\r\n  <div class=\"container py-5\">\r\n    <AdminNav />\r\n\r\n    <Spinner v-if=\"isLoading\" />\r\n    <table\r\n      v-else\r\n      class=\"table\"\r\n    >\r\n      <thead class=\"thead-dark\">\r\n        <tr>\r\n          <th scope=\"col\">\r\n            #\r\n          </th>\r\n          <th scope=\"col\">\r\n            Email\r\n          </th>\r\n          <th scope=\"col\">\r\n            Role\r\n          </th>\r\n          <th\r\n            scope=\"col\"\r\n            width=\"140\"\r\n          >\r\n            Action\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr\r\n          v-for=\"user in users\"\r\n          :key=\"user.id\"\r\n        >\r\n          <th scope=\"row\">\r\n            {{ user.id }}\r\n          </th>\r\n          <td>{{ user.email }}</td>\r\n          <td>{{ user.isAdmin ? 'admin' : 'user' }}</td>\r\n          <td>\r\n            <button\r\n              v-if=\"currentUser.id !== user.id\"\r\n              type=\"button\"\r\n              class=\"btn btn-link\"\r\n              @click=\"\r\n                toggleUserRole({ userId: user.id, isAdmin: user.isAdmin })\r\n              \"\r\n            >\r\n              {{ user.isAdmin ? 'set as user' : 'set as admin' }}\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AdminNav from './../components/AdminNav'\r\n\r\nimport { mapState } from 'vuex'\r\n\r\nimport adminAPI from './../apis/admin'\r\nimport { Toast } from './../utils/helpers'\r\n\r\nimport Spinner from './../components/Spinner'\r\n\r\nexport default {\r\n  components: {\r\n    AdminNav,\r\n    Spinner\r\n  },\r\n  data () {\r\n    return {\r\n      users: [],\r\n      isLoading: true\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['currentUser'])\r\n  },\r\n  created () {\r\n    this.fetchUsers()\r\n  },\r\n  methods: {\r\n    async fetchUsers () {\r\n      try {\r\n        this.isLoading = true\r\n        const { data } = await adminAPI.users.get()\r\n        if (data.status === 'error') {\r\n          throw new Error(data.message)\r\n        }\r\n        this.users = data.users\r\n        this.isLoading = false\r\n      } catch (error) {\r\n        this.isLoading = false\r\n        console.error(error.message)\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法取得會員資料，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async toggleUserRole ({ userId, isAdmin }) {\r\n      try {\r\n        const { data } = await adminAPI.users.update({\r\n          userId,\r\n          isAdmin: (!isAdmin).toString() // 避免型別轉換錯誤\r\n        })\r\n        if (data.status === 'error') {\r\n          throw new Error(data.message)\r\n        }\r\n        this.users = this.users.map(user => {\r\n          if (user.id === userId) {\r\n            return {\r\n              ...user,\r\n              isAdmin: !isAdmin // 反轉管理員權限的布林值\r\n            }\r\n          }\r\n          return user\r\n        })\r\n      } catch (error) {\r\n        console.error(error.message)\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '無法更新會員角色，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n","import { render } from \"./AdminUsers.vue?vue&type=template&id=6ee9e9ae\"\nimport script from \"./AdminUsers.vue?vue&type=script&lang=js\"\nexport * from \"./AdminUsers.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { apiHelper } from './../utils/helpers'\r\n\r\nexport default {\r\n  categories: {\r\n    getDetail ({ categoryId }) {\r\n      return apiHelper.get(`/admin/categories/${categoryId}`)\r\n    },\r\n    get () {\r\n      return apiHelper.get('/admin/categories')\r\n    },\r\n    create ({ name }) {\r\n      return apiHelper.post('/admin/categories', { name })\r\n    },\r\n    update ({ categoryId, name }) {\r\n      return apiHelper.put(`/admin/categories/${categoryId}`, { name })\r\n    },\r\n    delete ({ categoryId }) {\r\n      return apiHelper.delete(`/admin/categories/${categoryId}`)\r\n    }\r\n  },\r\n  restaurants: {\r\n    getDetail ({ restaurantId }) {\r\n      return apiHelper.get(`/admin/restaurants/${restaurantId}`)\r\n    },\r\n    get () {\r\n      return apiHelper.get('/admin/restaurants')\r\n    },\r\n    create ({ formData }) {\r\n      return apiHelper.post('/admin/restaurants', formData)\r\n    },\r\n    update ({ restaurantId, formData }) {\r\n      return apiHelper.put(`/admin/restaurants/${restaurantId}`, formData)\r\n    },\r\n    delete ({ restaurantId }) {\r\n      return apiHelper.delete(`/admin/restaurants/${restaurantId}`)\r\n    }\r\n  },\r\n  users: {\r\n    get () {\r\n      return apiHelper.get('/admin/users')\r\n    },\r\n    update ({ userId, isAdmin }) {\r\n      return apiHelper.put(\r\n        `/admin/users/${userId}`,\r\n        { isAdmin }\r\n      )\r\n    }\r\n  }\r\n}\r\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n// FF49- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\r\n  <div class=\"mb-3\">\r\n    <h1>餐廳後台</h1>\r\n    <router-link to=\"/admin/restaurants\">\r\n      Restaurants\r\n    </router-link>&nbsp;|\r\n    <router-link to=\"/admin/categories\">\r\n      Categories\r\n    </router-link>&nbsp;|\r\n    <router-link to=\"/admin/users\">\r\n      Users\r\n    </router-link>\r\n  </div>\r\n</template>\r\n","import { render } from \"./AdminNav.vue?vue&type=template&id=1bdbae34\"\nconst script = {}\nscript.render = render\n\nexport default script"],"sourceRoot":""}